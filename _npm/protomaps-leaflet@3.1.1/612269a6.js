/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/protomaps-leaflet@3.1.1/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import e from"../@mapbox/point-geometry@0.1.0/c33697cc.js";import{mix as t}from"../color2k@2.0.3/fd978833.js";import{VectorTile as i}from"../@mapbox/vector-tile@1.3.1/f8d85a7b.js";import n from"../pbf@3.3.0/de1c245c.js";import{PMTiles as a}from"../pmtiles@3.2.1/b0850c0a.js";import s from"../rbush@3.0.1/d425f52b.js";import o from"../potpack@1.0.2/85fad625.js";class r{constructor(e,t){this.str=null!=e?e:t,this.perFeature="function"==typeof this.str&&2===this.str.length}get(e,t){return"function"==typeof this.str?this.str(e,t):this.str}}class l{constructor(e,t=1){this.value=null!=e?e:t,this.perFeature="function"==typeof this.value&&2===this.value.length}get(e,t){return"function"==typeof this.value?this.value(e,t):this.value}}class c{constructor(e){var t;this.labelProps=null!==(t=null==e?void 0:e.labelProps)&&void 0!==t?t:["name"],this.textTransform=null==e?void 0:e.textTransform}get(e,t){let i,n,a;n="function"==typeof this.labelProps?this.labelProps(e,t):this.labelProps;for(const e of n)if(Object.prototype.hasOwnProperty.call(t.props,e)&&"string"==typeof t.props[e]){i=t.props[e];break}if(a="function"==typeof this.textTransform?this.textTransform(e,t):this.textTransform,i&&"uppercase"===a)i=i.toUpperCase();else if(i&&"lowercase"===a)i=i.toLowerCase();else if(i&&"capitalize"===a){const e=i.toLowerCase().split(" ");i=e.map((e=>e[0].toUpperCase()+e.slice(1))).join(" ")}return i}}class f{constructor(e){var t,i;(null==e?void 0:e.font)?this.font=e.font:(this.family=null!==(t=null==e?void 0:e.fontFamily)&&void 0!==t?t:"sans-serif",this.size=null!==(i=null==e?void 0:e.fontSize)&&void 0!==i?i:12,this.weight=null==e?void 0:e.fontWeight,this.style=null==e?void 0:e.fontStyle)}get(e,t){if(this.font)return"function"==typeof this.font?this.font(e,t):this.font;let i="";this.style&&(i="function"==typeof this.style?`${this.style(e,t)} `:`${this.style} `);let n,a,s="";return this.weight&&(s="function"==typeof this.weight?`${this.weight(e,t)} `:`${this.weight} `),n="function"==typeof this.size?this.size(e,t):this.size,a="function"==typeof this.family?this.family(e,t):this.family,`${i}${s}${n}px ${a}`}}class h{constructor(e,t=[]){this.value=null!=e?e:t,this.perFeature="function"==typeof this.value&&2===this.value.length}get(e,t){return"function"==typeof this.value?this.value(e,t):this.value}}const d=(e,t,i)=>{const n=[];let a,s,o,r=0,l=0,c=0,f=0,h=0,d=0,u=0,m=0,b=0,p=0,g=0,y=0;if(e.length<2)return[];if(2===e.length)return c=Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)),[{length:c,beginIndex:0,beginDistance:0,endIndex:2,endDistance:c}];for(f=Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)),r=1,l=e.length-1;r<l;r++)a=e[r-1],s=e[r],o=e[r+1],d=s.x-a.x,u=s.y-a.y,m=o.x-s.x,b=o.y-s.y,h=Math.sqrt(m*m+b*b),c+=f,p=Math.acos((d*m+u*b)/(f*h)),(p>t||c-y>i)&&(n.push({length:c-y,beginDistance:y,beginIndex:g,endIndex:r+1,endDistance:c}),g=r,y=c),f=h;return r-g>0&&n.push({length:c-y+h,beginIndex:g,beginDistance:y,endIndex:r+1,endDistance:c+h}),n};function u(e,t,i,n){const a=t.x-e.x,s=t.y-e.y,o=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=[];for(let t=0;t<i+n;t+=2*n){const i=1*t/o;r.push({x:e.x+i*a,y:e.y+i*s})}return r}function m(e,t){if(e.length<=t)return[e];const i=t-1,n=e.lastIndexOf(" ",i),a=e.indexOf(" ",i);if(-1===n&&-1===a)return[e];let s,o;return-1===a||n>=0&&i-n<a-i?(s=e.substring(0,n),o=e.substring(n+1,e.length)):(s=e.substring(0,a),o=e.substring(a+1,e.length)),[s,...m(o,t)]}var b,p=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};function g(e){return`${e.x}:${e.y}:${e.z}`}!function(e){e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.Polygon=3]="Polygon"}(b||(b={}));const y=(t,i,n)=>{t.pos=i;const a=t.readVarint()+t.pos;let s=1,o=0,r=0,l=0,c=1/0,f=-1/0,h=1/0,d=-1/0;const u=[];let m=[];for(;t.pos<a;){if(o<=0){const e=t.readVarint();s=7&e,o=e>>3}if(o--,1===s||2===s)r+=t.readSVarint()*n,l+=t.readSVarint()*n,r<c&&(c=r),r>f&&(f=r),l<h&&(h=l),l>d&&(d=l),1===s&&(m.length>0&&u.push(m),m=[]),m.push(new e(r,l));else{if(7!==s)throw new Error(`unknown command ${s}`);m&&m.push(m[0].clone())}}return m&&u.push(m),{geom:u,bbox:{minX:c,minY:h,maxX:f,maxY:d}}};function _(e,t){const a=new i(new n(e)),s=new Map;for(const[e,i]of Object.entries(a.layers)){const n=[],a=i;for(let e=0;e<a.length;e++){const i=y(a.feature(e)._pbf,a.feature(e)._geometry,t/a.extent);let s=0;for(const e of i.geom)s+=e.length;n.push({id:a.feature(e).id,geomType:a.feature(e).type,geom:i.geom,numVertices:s,bbox:i.bbox,props:a.feature(e).properties})}s.set(e,n)}return s}class w{constructor(e,t){this.p="string"==typeof e?new a(e):e,this.zoomaborts=[],this.shouldCancelZooms=t}get(e,t){return p(this,void 0,void 0,(function*(){this.shouldCancelZooms&&(this.zoomaborts=this.zoomaborts.filter((t=>t.z===e.z||(t.controller.abort(),!1))));const i=new AbortController;this.zoomaborts.push({z:e.z,controller:i});const n=i.signal,a=yield this.p.getZxy(e.z,e.x,e.y,n);return a?_(a.data,t):new Map}))}}class x{constructor(e,t){this.url=e,this.zoomaborts=[],this.shouldCancelZooms=t}get(e,t){return p(this,void 0,void 0,(function*(){this.shouldCancelZooms&&(this.zoomaborts=this.zoomaborts.filter((t=>t.z===e.z||(t.controller.abort(),!1))));const i=this.url.replace("{z}",e.z.toString()).replace("{x}",e.x.toString()).replace("{y}",e.y.toString()),n=new AbortController;this.zoomaborts.push({z:e.z,controller:n});const a=n.signal;return new Promise(((e,n)=>{fetch(i,{signal:a}).then((e=>e.arrayBuffer())).then((i=>{const n=_(i,t);e(n)})).catch((e=>{n(e)}))}))}))}}const k=6378137,v=85.0511287798,z=k*Math.PI;function M(e){return e*e}function T(e,t){return M(e.x-t.x)+M(e.y-t.y)}function C(t,i,n){const a=T(i,n);if(0===a)return T(t,i);let s=((t.x-i.x)*(n.x-i.x)+(t.y-i.y)*(n.y-i.y))/a;return s=Math.max(0,Math.min(1,s)),T(t,new e(i.x+s*(n.x-i.x),i.y+s*(n.y-i.y)))}function Y(e,t){let i=!1;for(let n=0,a=t.length-1;n<t.length;a=n++){const s=t[n].x,o=t[n].y,r=t[a].x,l=t[a].y;o>e.y!=l>e.y&&e.x<(r-s)*(e.y-o)/(l-o)+s&&(i=!i)}return i}function j(e){let t=0;for(let i=0;i<e.length;i++){const n=(i+1)%e.length;t+=e[i].x*e[n].y,t-=e[n].x*e[i].y}return t<0}function S(e,t){let i=!1;for(const n of t)if(j(n))Y(e,n)&&(i=!1);else{if(i)return!0;Y(e,n)&&(i=!0)}return i}function X(e,t){let i=1/0;for(const n of t){const t=Math.sqrt(T(e,n[0]));t<i&&(i=t)}return i}function P(e,t){let i=1/0;for(const n of t)for(let t=0;t<n.length-1;t++){const a=Math.sqrt(C(e,n[t],n[t+1]));a<i&&(i=a)}return i}class D{constructor(e,t){this.source=e,this.cache=new Map,this.inflight=new Map,this.tileSize=t}get(e){return p(this,void 0,void 0,(function*(){const t=g(e);return new Promise(((i,n)=>{const a=this.cache.get(t);if(a)a.used=performance.now(),i(a.data);else{const a=this.inflight.get(t);a?a.push({resolve:i,reject:n}):(this.inflight.set(t,[]),this.source.get(e,this.tileSize).then((e=>{this.cache.set(t,{used:performance.now(),data:e});const n=this.inflight.get(t);if(n)for(const t of n)t.resolve(e);if(this.inflight.delete(t),i(e),this.cache.size>=64){let e,t=1/0;this.cache.forEach(((i,n)=>{i.used<t&&(t=i.used,e=n)})),e&&this.cache.delete(e)}})).catch((e=>{const i=this.inflight.get(t);if(i)for(const t of i)t.reject(e);this.inflight.delete(t),n(e)})))}}))}))}queryFeatures(t,i,n,a){const s=(t=>{const i=Math.PI/180,n=Math.max(Math.min(v,t[0]),-85.0511287798),a=Math.sin(n*i);return new e(k*t[1]*i,k*Math.log((1+a)/(1-a))/2)})([i,t]),o=new e((s.x+z)/(2*z),1-(s.y+z)/(2*z));o.x>1&&(o.x=o.x-Math.floor(o.x));const r=o.mult(1<<n),l=Math.floor(r.x),c=Math.floor(r.y),f=g({z:n,x:l,y:c}),h=[],d=this.cache.get(f);if(d){const t=new e((r.x-l)*this.tileSize,(r.y-c)*this.tileSize);for(const[e,i]of d.data.entries())for(const n of i)n.geomType===b.Point?X(t,n.geom)<a&&h.push({feature:n,layerName:e}):n.geomType===b.Line?P(t,n.geom)<a&&h.push({feature:n,layerName:e}):S(t,n.geom)&&h.push({feature:n,layerName:e})}return h}}var R,F;!function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"}(R||(R={})),function(e){e[e.N=1]="N",e[e.Ne=2]="Ne",e[e.E=3]="E",e[e.Se=4]="Se",e[e.S=5]="S",e[e.Sw=6]="Sw",e[e.W=7]="W",e[e.Nw=8]="Nw"}(F||(F={}));const $=(e,t,i)=>{const n=document.createElement("canvas"),a=n.getContext("2d");return n.width=e,n.height=t,null!==a&&i(n,a),n};class I{constructor(e){var t;this.pattern=e.pattern,this.fill=new r(e.fill,"black"),this.opacity=new l(e.opacity,1),this.stroke=new r(e.stroke,"black"),this.width=new l(e.width,0),this.perFeature=null!==(t=this.fill.perFeature||this.opacity.perFeature||this.stroke.perFeature||this.width.perFeature||e.perFeature)&&void 0!==t&&t,this.doStroke=!1}before(e,t){if(!this.perFeature){e.globalAlpha=this.opacity.get(t),e.fillStyle=this.fill.get(t),e.strokeStyle=this.stroke.get(t);const i=this.width.get(t);i>0&&(this.doStroke=!0),e.lineWidth=i}if(this.pattern){const t=e.createPattern(this.pattern,"repeat");t&&(e.fillStyle=t)}}draw(e,t,i,n){let a=!1;if(this.perFeature){e.globalAlpha=this.opacity.get(i,n),e.fillStyle=this.fill.get(i,n);const t=this.width.get(i,n);t&&(a=!0,e.strokeStyle=this.stroke.get(i,n),e.lineWidth=t)}e.beginPath();for(const i of t)for(let t=0;t<i.length;t++){const n=i[t];0===t?e.moveTo(n.x,n.y):e.lineTo(n.x,n.y)}(()=>{e.fill(),(a||this.doStroke)&&e.stroke()})()}}function B(e,t){return i=>{const n=i-e;return n>=0&&n<t.length?t[n]:0}}function W(e,t){return i=>{if(t.length<1)return 0;if(i<=t[0][0])return t[0][1];if(i>=t[t.length-1][0])return t[t.length-1][1];const n=function(e,t){let i=0;for(;t[i+1][0]<e;)i++;return i}(i,t),a=function(e,t,i,n){const a=n[t+1][0]-n[t][0],s=e-n[t][0];return 0===a?0:1===i?s/a:(Math.pow(i,s)-1)/(Math.pow(i,a)-1)}(i,n,e,t);return function(e,t,i){return e*(i-t)+t}(a,t[n][1],t[n+1][1])}}function N(e,t){return i=>{if(t.length<1)return 0;let n=e;for(let e=0;e<t.length;e++)i>=t[e][0]&&(n=t[e][1]);return n}}function A(e){return W(1,e)}class q{constructor(e){var t;this.color=new r(e.color,"black"),this.width=new l(e.width),this.opacity=new l(e.opacity),this.dash=e.dash?new h(e.dash):null,this.dashColor=new r(e.dashColor,"black"),this.dashWidth=new l(e.dashWidth,1),this.lineCap=new r(e.lineCap,"butt"),this.lineJoin=new r(e.lineJoin,"miter"),this.skip=!1,this.perFeature=!!((null===(t=this.dash)||void 0===t?void 0:t.perFeature)||this.color.perFeature||this.opacity.perFeature||this.width.perFeature||this.lineCap.perFeature||this.lineJoin.perFeature||e.perFeature)}before(e,t){this.perFeature||(e.strokeStyle=this.color.get(t),e.lineWidth=this.width.get(t),e.globalAlpha=this.opacity.get(t),e.lineCap=this.lineCap.get(t),e.lineJoin=this.lineJoin.get(t))}draw(e,t,i,n){if(this.skip)return;e.beginPath();for(const i of t)for(let t=0;t<i.length;t++){const n=i[t];0===t?e.moveTo(n.x,n.y):e.lineTo(n.x,n.y)}(()=>{this.perFeature&&(e.globalAlpha=this.opacity.get(i,n),e.lineCap=this.lineCap.get(i,n),e.lineJoin=this.lineJoin.get(i,n)),this.dash?(e.save(),this.perFeature?(e.lineWidth=this.dashWidth.get(i,n),e.strokeStyle=this.dashColor.get(i,n),e.setLineDash(this.dash.get(i,n))):e.setLineDash(this.dash.get(i)),e.stroke(),e.restore()):(e.save(),this.perFeature&&(e.lineWidth=this.width.get(i,n),e.strokeStyle=this.color.get(i,n)),e.stroke(),e.restore())})()}}class K{constructor(e){this.name=e.name,this.sheet=e.sheet,this.dpr=window.devicePixelRatio}place(t,i,n){i[0];const a=new e(i[0][0].x,i[0][0].y),s=this.sheet.get(this.name),o=s.w/this.dpr,r=s.h/this.dpr;return[{anchor:a,bboxes:[{minX:a.x-o/2,minY:a.y-r/2,maxX:a.x+o/2,maxY:a.y+r/2}],draw:e=>{e.globalAlpha=1,e.drawImage(this.sheet.canvas,s.x,s.y,s.w,s.h,-s.w/2/this.dpr,-s.h/2/this.dpr,s.w/2,s.h/2)}}]}}class E{constructor(e){this.radius=new l(e.radius,3),this.fill=new r(e.fill,"black"),this.stroke=new r(e.stroke,"white"),this.width=new l(e.width,0),this.opacity=new l(e.opacity)}draw(e,t,i,n){e.globalAlpha=this.opacity.get(i,n);const a=this.radius.get(i,n),s=this.width.get(i,n);s>0&&(e.strokeStyle=this.stroke.get(i,n),e.lineWidth=s,e.beginPath(),e.arc(t[0][0].x,t[0][0].y,a+s/2,0,2*Math.PI),e.stroke()),e.fillStyle=this.fill.get(i,n),e.beginPath(),e.arc(t[0][0].x,t[0][0].y,a,0,2*Math.PI),e.fill()}place(t,i,n){i[0];const a=new e(i[0][0].x,i[0][0].y),s=this.radius.get(t.zoom,n);return[{anchor:a,bboxes:[{minX:a.x-s,minY:a.y-s,maxX:a.x+s,maxY:a.y+s}],draw:i=>{this.draw(i,[[new e(0,0)]],t.zoom,n)}}]}}class O{constructor(e){this.font=new f(e),this.text=new c(e),this.fill=new r(e.fill,"black"),this.background=new r(e.background,"white"),this.padding=new l(e.padding,0)}place(t,i,n){const a=this.text.get(t.zoom,n);if(!a)return;const s=this.font.get(t.zoom,n);t.scratch.font=s;const o=t.scratch.measureText(a),r=o.width,l=o.actualBoundingBoxAscent,c=o.actualBoundingBoxDescent;i[0];const f=new e(i[0][0].x,i[0][0].y),h=this.padding.get(t.zoom,n);return[{anchor:f,bboxes:[{minX:f.x-r/2-h,minY:f.y-l-h,maxX:f.x+r/2+h,maxY:f.y+c+h}],draw:e=>{e.globalAlpha=1,e.fillStyle=this.background.get(t.zoom,n),e.fillRect(-r/2-h,-l-h,r+2*h,l+c+2*h),e.fillStyle=this.fill.get(t.zoom,n),e.font=s,e.fillText(a,-r/2,0)}}]}}class Z{constructor(e){this.list=e}place(t,i,n){let a=this.list[0].place(t,i,n);if(!a)return;let s=a[0];const o=s.anchor;let r=s.bboxes[0];const l=r.maxY-r.minY,c=[{draw:s.draw,translate:{x:0,y:0}}],f=[[new e(i[0][0].x,i[0][0].y+l)]];for(let e=1;e<this.list.length;e++)a=this.list[e].place(t,f,n),a&&(s=a[0],r=U(r,s.bboxes[0]),c.push({draw:s.draw,translate:{x:0,y:l}}));return[{anchor:o,bboxes:[r],draw:e=>{for(const t of c)e.save(),e.translate(t.translate.x,t.translate.y),t.draw(e),e.restore()}}]}}const U=(e,t)=>({minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)});class H{constructor(e){this.list=e}place(e,t,i){const n=this.list[0];if(!n)return;let a=n.place(e,t,i);if(!a)return;let s=a[0];const o=s.anchor;let r=s.bboxes[0];const l=[s.draw];for(let n=1;n<this.list.length;n++){if(a=this.list[n].place(e,t,i),!a)return;s=a[0],r=U(r,s.bboxes[0]),l.push(s.draw)}return[{anchor:o,bboxes:[r],draw:e=>{for(const t of l)t(e)}}]}}class J{constructor(e){this.symbolizer=e}place(t,i,n){const a=i[0][0],s=this.symbolizer.place(t,[[new e(0,0)]],n);if(!s||0===s.length)return;const o=s[0],r=o.bboxes[0],l=r.maxX-r.minX,c=r.maxY-r.minY;return[{anchor:a,bboxes:[{minX:a.x-l/2,maxX:a.x+l/2,minY:a.y-c/2,maxY:a.y+c/2}],draw:e=>{e.translate(-l/2,c/2-r.maxY),o.draw(e,{justify:R.Center})}}]}}class V{constructor(e,t){this.padding=new l(e,0),this.symbolizer=t}place(e,t,i){const n=this.symbolizer.place(e,t,i);if(!n||0===n.length)return;const a=this.padding.get(e.zoom,i);for(const e of n)for(const t of e.bboxes)t.minX-=a,t.minY-=a,t.maxX+=a,t.maxY+=a;return n}}class G{constructor(e){this.font=new f(e),this.text=new c(e),this.fill=new r(e.fill,"black"),this.stroke=new r(e.stroke,"black"),this.width=new l(e.width,0),this.lineHeight=new l(e.lineHeight,1),this.letterSpacing=new l(e.letterSpacing,0),this.maxLineCodeUnits=new l(e.maxLineChars,15),this.justify=e.justify}place(t,i,n){const a=this.text.get(t.zoom,n);if(!a)return;const s=this.font.get(t.zoom,n);t.scratch.font=s;const o=this.letterSpacing.get(t.zoom,n),r=m(a,this.maxLineCodeUnits.get(t.zoom,n));let l="",c=0;for(const e of r)e.length>c&&(c=e.length,l=e);const f=t.scratch.measureText(l),h=f.width+o*(c-1),d=f.actualBoundingBoxAscent,u=f.actualBoundingBoxDescent,b=(d+u)*this.lineHeight.get(t.zoom,n),p=new e(i[0][0].x,i[0][0].y);return[{anchor:p,bboxes:[{minX:p.x,minY:p.y-d,maxX:p.x+h,maxY:p.y+u+(r.length-1)*b}],draw:(e,i)=>{e.globalAlpha=1,e.font=s,e.fillStyle=this.fill.get(t.zoom,n);const a=this.width.get(t.zoom,n);let l=0;for(const s of r){let r=0;if(this.justify===R.Center||i&&i.justify===R.Center?r=(h-e.measureText(s).width)/2:(this.justify===R.Right||i&&i.justify===R.Right)&&(r=h-e.measureText(s).width),a)if(e.lineWidth=2*a,e.strokeStyle=this.stroke.get(t.zoom,n),o>0){let t=r;for(const i of s)e.strokeText(i,t,l),t+=e.measureText(i).width+o}else e.strokeText(s,r,l);if(o>0){let t=r;for(const i of s)e.fillText(i,t,l),t+=e.measureText(i).width+o}else e.fillText(s,r,l);l+=b}}}]}}class Q{constructor(e){this.centered=new J(new G(e))}place(e,t,i){return this.centered.place(e,t,i)}}class ee{constructor(e,t){var i,n,a;this.symbolizer=e,this.offsetX=new l(t.offsetX,0),this.offsetY=new l(t.offsetY,0),this.justify=null!==(i=t.justify)&&void 0!==i?i:void 0,this.placements=null!==(n=t.placements)&&void 0!==n?n:[F.Ne,F.Sw,F.Nw,F.Se,F.N,F.E,F.S,F.W],this.ddValues=null!==(a=t.ddValues)&&void 0!==a?a:()=>({})}place(t,i,n){if(n.geomType!==b.Point)return;const a=i[0][0],s=this.symbolizer.place(t,[[new e(0,0)]],n);if(!s||0===s.length)return;const o=s[0],r=o.bboxes[0];let c=this.offsetX,f=this.offsetY,h=this.justify,d=this.placements;const{offsetX:u,offsetY:m,justify:p,placements:g}=this.ddValues(t.zoom,n)||{};u&&(c=new l(u,0)),m&&(f=new l(m,0)),p&&(h=p),g&&(d=g);const y=c.get(t.zoom,n),_=f.get(t.zoom,n);let w,x=new e(y,_);const k=e=>{e.translate(x.x,x.y),o.draw(e,{justify:w})},v=(e,i)=>{const n=((e,t)=>({minX:e.x+t.x+r.minX,minY:e.y+t.y+r.minY,maxX:e.x+t.x+r.maxX,maxY:e.y+t.y+r.maxY}))(e,i);if(!t.index.bboxCollides(n,t.order))return[{anchor:a,bboxes:[n],draw:k}]};for(const t of d){const i=this.computeXaxisOffset(y,r,t),n=this.computeYaxisOffset(_,r,t);return w=this.computeJustify(h,t),x=new e(i,n),v(a,x)}}computeXaxisOffset(e,t,i){const n=t.maxX,a=n/2;return[F.N,F.S].includes(i)?e-a:[F.Nw,F.W,F.Sw].includes(i)?e-n:e}computeYaxisOffset(e,t,i){const n=Math.abs(t.minY),a=t.maxY,s=(t.minY+t.maxY)/2;return[F.E,F.W].includes(i)?e-s:[F.Nw,F.Ne,F.N].includes(i)?e-a:[F.Sw,F.Se,F.S].includes(i)?e+n:e}computeJustify(e,t){return e||([F.N,F.S].includes(t)?R.Center:[F.Ne,F.E,F.Se].includes(t)?R.Left:R.Right)}}class te{constructor(e){this.symbolizer=new ee(new G(e),e)}place(e,t,i){return this.symbolizer.place(e,t,i)}}var ie;!function(e){e[e.Above=1]="Above",e[e.Center=2]="Center",e[e.Below=3]="Below"}(ie||(ie={}));class ne{constructor(e){var t;this.font=new f(e),this.text=new c(e),this.fill=new r(e.fill,"black"),this.stroke=new r(e.stroke,"black"),this.width=new l(e.width,0),this.offset=new l(e.offset,0),this.position=null!==(t=e.position)&&void 0!==t?t:ie.Above,this.maxLabelCodeUnits=new l(e.maxLabelChars,40),this.repeatDistance=new l(e.repeatDistance,250)}place(t,i,n){const a=this.text.get(t.zoom,n);if(!a)return;if(a.length>this.maxLabelCodeUnits.get(t.zoom,n))return;const s=n.bbox;if(s.maxY-s.minY<20&&s.maxX-s.minX<20)return;const o=this.font.get(t.zoom,n);t.scratch.font=o;const r=t.scratch.measureText(a),l=r.width,c=r.actualBoundingBoxAscent+r.actualBoundingBoxDescent;let f=this.repeatDistance.get(t.zoom,n);t.overzoom>4&&(f*=1<<t.overzoom-4);const h=2*c,m=function(t,i,n,a){const s=[];for(const o of t){const t=d(o,Math.PI/45,i);for(const r of t)if(r.length>=i+a){const t=new e(o[r.beginIndex].x,o[r.beginIndex].y),l=o[r.endIndex-1],c=new e((l.x-t.x)/r.length,(l.y-t.y)/r.length);for(let e=a;e<r.length-i;e+=n)s.push({start:t.add(c.mult(e)),end:t.add(c.mult(e+i))})}}return s}(i,l,f,h);if(0===m.length)return;const b=[];for(const e of m){const i=e.end.x-e.start.x,s=e.end.y-e.start.y,r=u(e.start,e.end,l,h/2).map((e=>({minX:e.x-h/2,minY:e.y-h/2,maxX:e.x+h/2,maxY:e.y+h/2}))),d=e=>{e.globalAlpha=1,e.rotate(Math.atan2(s,i)),i<0&&(e.scale(-1,-1),e.translate(-l,0));let r=0;this.position===ie.Below?r+=c:this.position===ie.Center&&(r+=c/2),e.translate(0,r-this.offset.get(t.zoom,n)),e.font=o;const f=this.width.get(t.zoom,n);f&&(e.lineWidth=f,e.strokeStyle=this.stroke.get(t.zoom,n),e.strokeText(a,0,0)),e.fillStyle=this.fill.get(t.zoom,n),e.fillText(a,0,0)};b.push({anchor:e.start,bboxes:r,draw:d,deduplicationKey:a,deduplicationDistance:f})}return b}}const ae=(e,t)=>{const i=e[t];return"string"==typeof i?i:""},se=(e,t)=>{const i=e[t];return"number"==typeof i?i:0},oe=e=>[{dataLayer:"earth",symbolizer:new I({fill:e.earth})},{dataLayer:"landuse",symbolizer:new I({fill:(i,n)=>t(e.park_a,e.park_b,Math.min(Math.max(i/12,12),0))}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["allotments","village_green","playground"].includes(i)}},{dataLayer:"landuse",symbolizer:new I({fill:e.park_b,opacity:.7}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course"].includes(i)}},{dataLayer:"landuse",symbolizer:new I({fill:e.hospital}),filter:(e,t)=>"hospital"===t.props["pmap:kind"]},{dataLayer:"landuse",symbolizer:new I({fill:e.industrial}),filter:(e,t)=>"industrial"===t.props["pmap:kind"]},{dataLayer:"landuse",symbolizer:new I({fill:e.school}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["school","university","college"].includes(i)}},{dataLayer:"landuse",symbolizer:new I({fill:e.beach}),filter:(e,t)=>"beach"===t.props["pmap:kind"]},{dataLayer:"landuse",symbolizer:new I({fill:e.zoo}),filter:(e,t)=>"zoo"===t.props["pmap:kind"]},{dataLayer:"landuse",symbolizer:new I({fill:e.zoo}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["military","naval_base","airfield"].includes(i)}},{dataLayer:"natural",symbolizer:new I({fill:(i,n)=>t(e.wood_a,e.wood_b,Math.min(Math.max(i/12,12),0))}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["wood","nature_reserve","forest"].includes(i)}},{dataLayer:"natural",symbolizer:new I({fill:(i,n)=>t(e.scrub_a,e.scrub_b,Math.min(Math.max(i/12,12),0))}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["scrub","grassland","grass"].includes(i)}},{dataLayer:"natural",symbolizer:new I({fill:e.scrub_b}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["scrub","grassland","grass"].includes(i)}},{dataLayer:"natural",symbolizer:new I({fill:e.glacier}),filter:(e,t)=>"glacier"===t.props["pmap:kind"]},{dataLayer:"natural",symbolizer:new I({fill:e.sand}),filter:(e,t)=>"sand"===t.props["pmap:kind"]},{dataLayer:"landuse",symbolizer:new I({fill:e.aerodrome}),filter:(e,t)=>"aerodrome"===t.props["pmap:kind"]},{dataLayer:"water",symbolizer:new I({fill:e.water})},{dataLayer:"transit",symbolizer:new q({color:e.runway,width:(e,t)=>W(1.6,[[11,0],[13,4],[19,30]])(e)}),filter:(e,t)=>"runway"===t.props["pmap:kind_detail"]},{dataLayer:"transit",symbolizer:new q({color:e.runway,width:(e,t)=>W(1.6,[[14,0],[14.5,1],[16,6]])(e)}),filter:(e,t)=>"taxiway"===t.props["pmap:kind_detail"]},{dataLayer:"transit",symbolizer:new q({color:e.pier,width:(e,t)=>W(1.6,[[13,0],[13.5,0,5],[21,16]])(e)}),filter:(e,t)=>"pier"===t.props["pmap:kind"]},{dataLayer:"physical_line",minzoom:14,symbolizer:new q({color:e.water,width:(e,t)=>W(1.6,[[9,0],[9.5,1],[18,12]])(e)}),filter:(e,t)=>"river"===t.props["pmap:kind"]},{dataLayer:"physical_line",minzoom:14,symbolizer:new q({color:e.water,width:.5}),filter:(e,t)=>"stream"===t.props["pmap:kind"]},{dataLayer:"landuse",symbolizer:new I({fill:e.pedestrian}),filter:(e,t)=>"pedestrian"===t.props["pmap:kind"]},{dataLayer:"landuse",symbolizer:new I({fill:e.pier}),filter:(e,t)=>"pier"===t.props["pmap:kind"]},{dataLayer:"buildings",symbolizer:new I({fill:e.buildings,opacity:.5})},{dataLayer:"roads",symbolizer:new q({color:e.major,width:(e,t)=>W(1.6,[[14,0],[20,7]])(e)}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["other","path"].includes(i)}},{dataLayer:"roads",symbolizer:new q({color:e.major,width:(e,t)=>W(1.6,[[13,0],[18,8]])(e)}),filter:(e,t)=>"minor_road"===t.props["pmap:kind"]},{dataLayer:"roads",symbolizer:new q({color:e.major,width:(e,t)=>W(1.6,[[7,0],[12,1.2],[15,3],[18,13]])(e)}),filter:(e,t)=>"medium_road"===t.props["pmap:kind"]},{dataLayer:"roads",symbolizer:new q({color:e.major,width:(e,t)=>W(1.6,[[6,0],[12,1.6],[15,3],[18,13]])(e)}),filter:(e,t)=>"major_road"===t.props["pmap:kind"]},{dataLayer:"roads",symbolizer:new q({color:e.major,width:(e,t)=>W(1.6,[[3,0],[6,1.1],[12,1.6],[15,5],[18,15]])(e)}),filter:(e,t)=>"highway"===t.props["pmap:kind"]},{dataLayer:"boundaries",symbolizer:new q({dash:[3,2],color:e.boundaries,width:1}),filter:(e,t)=>{const i=t.props["pmap:min_admin_level"];return"number"==typeof i&&i<=2}},{dataLayer:"transit",symbolizer:new q({dash:[.3,.75],color:e.railway,dashWidth:(e,t)=>W(1.6,[[4,0],[7,.15],[19,9]])(e),opacity:.5}),filter:(e,t)=>"rail"===t.props["pmap:kind"]},{dataLayer:"boundaries",symbolizer:new q({dash:[3,2],color:e.boundaries,width:.5}),filter:(e,t)=>{const i=t.props["pmap:min_admin_level"];return"number"==typeof i&&i>2}}],re=e=>{const t=["name"];return[{dataLayer:"roads",symbolizer:new ne({labelProps:t,fill:e.roads_label_minor,font:"400 12px sans-serif",width:2,stroke:e.roads_label_minor_halo}),minzoom:16,filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["minor_road","other","path"].includes(i)}},{dataLayer:"roads",symbolizer:new ne({labelProps:t,fill:e.roads_label_major,font:"400 12px sans-serif",width:2,stroke:e.roads_label_major_halo}),minzoom:12,filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["highway","major_road","medium_road"].includes(i)}},{dataLayer:"roads",symbolizer:new ne({labelProps:t,fill:e.roads_label_major,font:"400 12px sans-serif",width:2,stroke:e.roads_label_major_halo}),minzoom:12,filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["highway","major_road","medium_road"].includes(i)}},{dataLayer:"physical_point",symbolizer:new Q({labelProps:t,fill:e.ocean_label,lineHeight:1.5,letterSpacing:1,font:(e,t)=>`400 ${A([[3,10],[10,12]])(e)}px sans-serif`,textTransform:"uppercase"}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["ocean","bay","strait","fjord"].includes(i)}},{dataLayer:"physical_point",symbolizer:new Q({labelProps:t,fill:e.ocean_label,lineHeight:1.5,letterSpacing:1,font:(e,t)=>`400 ${A([[3,0],[6,12],[10,12]])(e)}px sans-serif`}),filter:(e,t)=>{const i=ae(t.props,"pmap:kind");return["sea","lake","water"].includes(i)}},{dataLayer:"places",symbolizer:new Q({labelProps:(e,i)=>e<6?["name:short"]:t,fill:e.state_label,stroke:e.state_label_halo,width:1,lineHeight:1.5,font:(e,t)=>e<6?"400 16px sans-serif":"400 12px sans-serif",textTransform:"uppercase"}),filter:(e,t)=>"region"===t.props["pmap:kind"]},{dataLayer:"places",symbolizer:new Q({labelProps:t,fill:e.country_label,lineHeight:1.5,font:(e,t)=>"600 12px sans-serif",textTransform:"uppercase"}),filter:(e,t)=>"country"===t.props["pmap:kind"]},{dataLayer:"places",minzoom:9,symbolizer:new Q({labelProps:t,fill:e.city_label,lineHeight:1.5,font:(e,t)=>{if(!t)return"400 12px sans-serif";const i=t.props["pmap:min_zoom"];let n=400;i&&i<=5&&(n=600);let a=12;const s=t.props["pmap:population_rank"];return s&&s>9&&(a=16),`${n} ${a}px sans-serif`}}),sort:(e,t)=>se(e,"pmap:population_rank")-se(t,"pmap:population_rank"),filter:(e,t)=>"locality"===t.props["pmap:kind"]},{dataLayer:"places",maxzoom:8,symbolizer:new H([new E({radius:2,fill:e.city_circle,stroke:e.city_circle_stroke,width:1.5}),new te({labelProps:t,fill:e.city_label,stroke:e.city_label_halo,width:1,offsetX:6,offsetY:4.5,font:(e,t)=>"400 12px sans-serif"})]),filter:(e,t)=>"locality"===t.props["pmap:kind"]}]},le={light:{background:"#cccccc",earth:"#e0e0e0",park_a:"#cfddd5",park_b:"#9cd3b4",hospital:"#e4dad9",industrial:"#d1dde1",school:"#e4ded7",wood_a:"#d0ded0",wood_b:"#a0d9a0",pedestrian:"#e3e0d4",scrub_a:"#cedcd7",scrub_b:"#99d2bb",glacier:"#e7e7e7",sand:"#e2e0d7",beach:"#e8e4d0",aerodrome:"#dadbdf",runway:"#e9e9ed",water:"#80deea",pier:"#e0e0e0",zoo:"#c6dcdc",military:"#dcdcdc",tunnel_other_casing:"#e0e0e0",tunnel_minor_casing:"#e0e0e0",tunnel_link_casing:"#e0e0e0",tunnel_medium_casing:"#e0e0e0",tunnel_major_casing:"#e0e0e0",tunnel_highway_casing:"#e0e0e0",tunnel_other:"#d5d5d5",tunnel_minor:"#d5d5d5",tunnel_link:"#d5d5d5",tunnel_medium:"#d5d5d5",tunnel_major:"#d5d5d5",tunnel_highway:"#d5d5d5",transit_pier:"#e0e0e0",buildings:"#cccccc",minor_service_casing:"#e0e0e0",minor_casing:"#e0e0e0",link_casing:"#e0e0e0",medium_casing:"#e0e0e0",major_casing_late:"#e0e0e0",highway_casing_late:"#e0e0e0",other:"#ebebeb",minor_service:"#ebebeb",minor_a:"#ebebeb",minor_b:"#ffffff",link:"#ffffff",medium:"#f5f5f5",major_casing_early:"#e0e0e0",major:"#ffffff",highway_casing_early:"#e0e0e0",highway:"#ffffff",railway:"#a7b1b3",boundaries:"#adadad",waterway_label:"#ffffff",bridges_other_casing:"#e0e0e0",bridges_minor_casing:"#e0e0e0",bridges_link_casing:"#e0e0e0",bridges_medium_casing:"#e0e0e0",bridges_major_casing:"#e0e0e0",bridges_highway_casing:"#e0e0e0",bridges_other:"#ebebeb",bridges_minor:"#ffffff",bridges_link:"#ffffff",bridges_medium:"#f0eded",bridges_major:"#f5f5f5",bridges_highway:"#ffffff",roads_label_minor:"#91888b",roads_label_minor_halo:"#ffffff",roads_label_major:"#938a8d",roads_label_major_halo:"#ffffff",ocean_label:"#ffffff",peak_label:"#7e9aa0",subplace_label:"#8f8f8f",subplace_label_halo:"#e0e0e0",city_circle:"#ffffff",city_circle_stroke:"#a3a3a3",city_label:"#5c5c5c",city_label_halo:"#e0e0e0",state_label:"#b3b3b3",state_label_halo:"#e0e0e0",country_label:"#a3a3a3"},dark:{background:"#34373d",earth:"#1f1f1f",park_a:"#232325",park_b:"#232325",hospital:"#252424",industrial:"#222222",school:"#262323",wood_a:"#202121",wood_b:"#202121",pedestrian:"#1e1e1e",scrub_a:"#222323",scrub_b:"#222323",glacier:"#1c1c1c",sand:"#212123",beach:"#28282a",aerodrome:"#1e1e1e",runway:"#333333",water:"#34373d",pier:"#222222",zoo:"#222323",military:"#242323",tunnel_other_casing:"#141414",tunnel_minor_casing:"#141414",tunnel_link_casing:"#141414",tunnel_medium_casing:"#141414",tunnel_major_casing:"#141414",tunnel_highway_casing:"#141414",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_medium:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",transit_pier:"#333333",buildings:"#111111",minor_service_casing:"#1f1f1f",minor_casing:"#1f1f1f",link_casing:"#1f1f1f",medium_casing:"#1f1f1f",major_casing_late:"#1f1f1f",highway_casing_late:"#1f1f1f",other:"#333333",minor_service:"#333333",minor_a:"#3d3d3d",minor_b:"#333333",link:"#3d3d3d",medium:"#3d3d3d",major_casing_early:"#1f1f1f",major:"#3d3d3d",highway_casing_early:"#1f1f1f",highway:"#474747",railway:"#000000",boundaries:"#5b6374",waterway_label:"#717784",bridges_other_casing:"#2b2b2b",bridges_minor_casing:"#1f1f1f",bridges_link_casing:"#1f1f1f",bridges_medium_casing:"#1f1f1f",bridges_major_casing:"#1f1f1f",bridges_highway_casing:"#1f1f1f",bridges_other:"#333333",bridges_minor:"#333333",bridges_link:"#3d3d3d",bridges_medium:"#3d3d3d",bridges_major:"#3d3d3d",bridges_highway:"#474747",roads_label_minor:"#525252",roads_label_minor_halo:"#1f1f1f",roads_label_major:"#666666",roads_label_major_halo:"#1f1f1f",ocean_label:"#717784",peak_label:"#898080",subplace_label:"#525252",subplace_label_halo:"#1f1f1f",city_circle:"#000000",city_circle_stroke:"#7a7a7a",city_label:"#7a7a7a",city_label_halo:"#212121",state_label:"#3d3d3d",state_label_halo:"#1f1f1f",country_label:"#5c5c5c"},white:{background:"#ffffff",earth:"#ffffff",park_a:"#fcfcfc",park_b:"#fcfcfc",hospital:"#f8f8f8",industrial:"#fcfcfc",school:"#f8f8f8",wood_a:"#fafafa",wood_b:"#fafafa",pedestrian:"#fdfdfd",scrub_a:"#fafafa",scrub_b:"#fafafa",glacier:"#fcfcfc",sand:"#fafafa",beach:"#f6f6f6",aerodrome:"#fdfdfd",runway:"#efefef",water:"#dcdcdc",pier:"#f5f5f5",zoo:"#f7f7f7",military:"#fcfcfc",tunnel_other_casing:"#d6d6d6",tunnel_minor_casing:"#fcfcfc",tunnel_link_casing:"#fcfcfc",tunnel_medium_casing:"#fcfcfc",tunnel_major_casing:"#fcfcfc",tunnel_highway_casing:"#fcfcfc",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_medium:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",transit_pier:"#efefef",buildings:"#efefef",minor_service_casing:"#ffffff",minor_casing:"#ffffff",link_casing:"#ffffff",medium_casing:"#ffffff",major_casing_late:"#ffffff",highway_casing_late:"#ffffff",other:"#f5f5f5",minor_service:"#f5f5f5",minor_a:"#ebebeb",minor_b:"#f5f5f5",link:"#ebebeb",medium:"#ebebeb",major_casing_early:"#ffffff",major:"#ebebeb",highway_casing_early:"#ffffff",highway:"#ebebeb",railway:"#d6d6d6",boundaries:"#adadad",waterway_label:"#adadad",bridges_other_casing:"#ffffff",bridges_minor_casing:"#ffffff",bridges_link_casing:"#ffffff",bridges_medium_casing:"#ffffff",bridges_major_casing:"#ffffff",bridges_highway_casing:"#ffffff",bridges_other:"#f5f5f5",bridges_minor:"#f5f5f5",bridges_link:"#ebebeb",bridges_medium:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#adadad",roads_label_minor_halo:"#ffffff",roads_label_major:"#999999",roads_label_major_halo:"#ffffff",ocean_label:"#adadad",peak_label:"#adadad",subplace_label:"#8f8f8f",subplace_label_halo:"#ffffff",city_circle:"#ffffff",city_circle_stroke:"#adadad",city_label:"#5c5c5c",city_label_halo:"#ffffff",state_label:"#b3b3b3",state_label_halo:"#ffffff",country_label:"#b8b8b8"},grayscale:{background:"#a3a3a3",earth:"#cccccc",park_a:"#c2c2c2",park_b:"#c2c2c2",hospital:"#d0d0d0",industrial:"#c6c6c6",school:"#d0d0d0",wood_a:"#c2c2c2",wood_b:"#c2c2c2",pedestrian:"#c4c4c4",scrub_a:"#c2c2c2",scrub_b:"#c2c2c2",glacier:"#d2d2d2",sand:"#d2d2d2",beach:"#d2d2d2",aerodrome:"#c9c9c9",runway:"#f5f5f5",water:"#a3a3a3",pier:"#b8b8b8",zoo:"#c7c7c7",military:"#bfbfbf",tunnel_other_casing:"#b8b8b8",tunnel_minor_casing:"#b8b8b8",tunnel_link_casing:"#b8b8b8",tunnel_medium_casing:"#b8b8b8",tunnel_major_casing:"#b8b8b8",tunnel_highway_casing:"#b8b8b8",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_medium:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",transit_pier:"#b8b8b8",buildings:"#e0e0e0",minor_service_casing:"#cccccc",minor_casing:"#cccccc",link_casing:"#cccccc",medium_casing:"#cccccc",major_casing_late:"#cccccc",highway_casing_late:"#cccccc",other:"#e0e0e0",minor_service:"#e0e0e0",minor_a:"#ebebeb",minor_b:"#e0e0e0",link:"#ebebeb",medium:"#ebebeb",major_casing_early:"#cccccc",major:"#ebebeb",highway_casing_early:"#cccccc",highway:"#ebebeb",railway:"#f5f5f5",boundaries:"#5c5c5c",waterway_label:"#7a7a7a",bridges_other_casing:"#cccccc",bridges_minor_casing:"#cccccc",bridges_link_casing:"#cccccc",bridges_medium_casing:"#cccccc",bridges_major_casing:"#cccccc",bridges_highway_casing:"#cccccc",bridges_other:"#e0e0e0",bridges_minor:"#e0e0e0",bridges_link:"#ebebeb",bridges_medium:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#999999",roads_label_minor_halo:"#e0e0e0",roads_label_major:"#8f8f8f",roads_label_major_halo:"#ebebeb",ocean_label:"#7a7a7a",peak_label:"#5c5c5c",subplace_label:"#7a7a7a",subplace_label_halo:"#cccccc",city_circle:"#c2c2c2",city_circle_stroke:"#7a7a7a",city_label:"#474747",city_label_halo:"#cccccc",state_label:"#999999",state_label_halo:"#cccccc",country_label:"#858585"},black:{background:"#2b2b2b",earth:"#141414",park_a:"#181818",park_b:"#181818",hospital:"#1d1d1d",industrial:"#101010",school:"#111111",wood_a:"#1a1a1a",wood_b:"#1a1a1a",pedestrian:"#191919",scrub_a:"#1c1c1c",scrub_b:"#1c1c1c",glacier:"#191919",sand:"#161616",beach:"#1f1f1f",aerodrome:"#191919",runway:"#323232",water:"#333333",pier:"#0a0a0a",zoo:"#191919",military:"#121212",tunnel_other_casing:"#101010",tunnel_minor_casing:"#101010",tunnel_link_casing:"#101010",tunnel_medium_casing:"#101010",tunnel_major_casing:"#101010",tunnel_highway_casing:"#101010",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_medium:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",transit_pier:"#0a0a0a",buildings:"#0a0a0a",minor_service_casing:"#141414",minor_casing:"#141414",link_casing:"#141414",medium_casing:"#141414",major_casing_late:"#141414",highway_casing_late:"#141414",other:"#1f1f1f",minor_service:"#1f1f1f",minor_a:"#292929",minor_b:"#1f1f1f",link:"#1f1f1f",medium:"#292929",major_casing_early:"#141414",major:"#292929",highway_casing_early:"#141414",highway:"#292929",railway:"#292929",boundaries:"#707070",waterway_label:"#707070",bridges_other_casing:"#141414",bridges_minor_casing:"#141414",bridges_link_casing:"#141414",bridges_medium_casing:"#141414",bridges_major_casing:"#141414",bridges_highway_casing:"#141414",bridges_other:"#1f1f1f",bridges_minor:"#1f1f1f",bridges_link:"#292929",bridges_medium:"#292929",bridges_major:"#292929",bridges_highway:"#292929",roads_label_minor:"#525252",roads_label_minor_halo:"#141414",roads_label_major:"#5c5c5c",roads_label_major_halo:"#141414",ocean_label:"#707070",peak_label:"#707070",subplace_label:"#5c5c5c",subplace_label_halo:"#141414",city_circle:"#000000",city_circle_stroke:"#666666",city_label:"#999999",city_label_halo:"#141414",state_label:"#3d3d3d",state_label_halo:"#141414",country_label:"#707070"}};var ce=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const fe=(e,t,i)=>{const n=[];for(const a of e){const e=[];for(const n of a)e.push(n.clone().mult(t).add(i));n.push(e)}return n},he=(e,t)=>{const i=1<<t;return e<0?i+e:e>=i?e%i:e};class de{constructor(e,t,i){this.tileCache=e,this.maxDataLevel=t,this.levelDiff=i}dataTilesForBounds(t,i){const n=Math.pow(2,t)/Math.pow(2,Math.ceil(t)),a=[];let s=1;const o=this.tileCache.tileSize;if(t<this.levelDiff)s=1/(1<<this.levelDiff-t)*n,a.push({dataTile:{z:0,x:0,y:0},origin:new e(0,0),scale:s,dim:o*s});else if(t<=this.levelDiff+this.maxDataLevel){const s=1<<this.levelDiff,r=256*n,l=Math.ceil(t)-this.levelDiff,c=Math.floor(i.minX/s/r),f=Math.floor(i.minY/s/r),h=Math.floor(i.maxX/s/r),d=Math.floor(i.maxY/s/r);for(let t=c;t<=h;t++)for(let i=f;i<=d;i++){const c=new e(t*s*r,i*s*r);a.push({dataTile:{z:l,x:he(t,l),y:he(i,l)},origin:c,scale:n,dim:o*n})}}else{const r=1<<this.levelDiff;s=(1<<Math.ceil(t)-this.maxDataLevel-this.levelDiff)*n;const l=Math.floor(i.minX/r/256/s),c=Math.floor(i.minY/r/256/s),f=Math.floor(i.maxX/r/256/s),h=Math.floor(i.maxY/r/256/s);for(let t=l;t<=f;t++)for(let i=c;i<=h;i++){const n=new e(t*r*256*s,i*r*256*s);a.push({dataTile:{z:this.maxDataLevel,x:he(t,this.maxDataLevel),y:he(i,this.maxDataLevel)},origin:n,scale:s,dim:o*s})}}return a}dataTileForDisplayTile(t){let i,n,a=1,s=this.tileCache.tileSize;if(t.z<this.levelDiff)i={z:0,x:0,y:0},a=1/(1<<this.levelDiff-t.z),n=new e(0,0),s*=a;else if(t.z<=this.levelDiff+this.maxDataLevel){const a=1<<this.levelDiff;i={z:t.z-this.levelDiff,x:Math.floor(t.x/a),y:Math.floor(t.y/a)},n=new e(i.x*a*256,i.y*a*256)}else{a=1<<t.z-this.maxDataLevel-this.levelDiff;const o=1<<this.levelDiff;i={z:this.maxDataLevel,x:Math.floor(t.x/o/a),y:Math.floor(t.y/o/a)},n=new e(i.x*o*a*256,i.y*o*a*256),s*=a}return{dataTile:i,scale:a,origin:n,dim:s}}getBbox(e,t){return ce(this,void 0,void 0,(function*(){const i=this.dataTilesForBounds(e,t);return(yield Promise.all(i.map((e=>this.tileCache.get(e.dataTile))))).map(((t,n)=>{const a=i[n];return{data:t,z:e,dataTile:a.dataTile,scale:a.scale,dim:a.dim,origin:a.origin}}))}))}getDisplayTile(e){return ce(this,void 0,void 0,(function*(){const t=this.dataTileForDisplayTile(e);return{data:yield this.tileCache.get(t.dataTile),z:e.z,dataTile:t.dataTile,scale:t.scale,origin:t.origin,dim:t.dim}}))}queryFeatures(e,t,i,n){const a=Math.round(i),s=Math.min(a-this.levelDiff,this.maxDataLevel),o=n/(1<<a-s);return this.tileCache.queryFeatures(e,t,s,o)}}const ue=e=>{const t=e=>{const t=void 0===e.levelDiff?1:e.levelDiff,i=e.maxDataZoom||15;let n;if("string"==typeof e.url)n=e.url.startsWith("http")&&new URL(e.url).pathname.endsWith(".pmtiles")?new w(e.url,!0):new x(e.url,!0);else{if(!e.url)throw new Error(`Invalid source ${e.url}`);n=new w(e.url,!0)}const a=new D(n,256<<t);return new de(a,i,t)},i=new Map;if(e.sources)for(const n in e.sources)i.set(n,t(e.sources[n]));else i.set("",t(e));return i},me=(e,t,i)=>{const n=256,a=t/n,s=Math.floor(i.minX/n),o=Math.floor(i.minY/n),r=Math.floor(i.maxX/n),l=Math.floor(i.maxY/n),c=Math.log2(a),f=[];for(let t=s;t<=r;t++){const i=t%(1<<e);for(let t=o;t<=l;t++)f.push({display:g({z:e,x:i,y:t}),key:g({z:e-c,x:Math.floor(i/a),y:Math.floor(t/a)})})}return f};class be{constructor(e,t){this.tree=new s,this.current=new Map,this.dim=e,this.maxLabeledTiles=t}hasPrefix(e){for(const t of this.current.keys())if(t.startsWith(e))return!0;return!1}has(e){return this.current.has(e)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(e,t){const i=new Set;for(const n of this.tree.search(e))n.indexedLabel.order<=t&&i.add(n.indexedLabel);return i}searchLabel(e,t){const i=new Set;for(const n of e.bboxes)for(const e of this.tree.search(n))e.indexedLabel.order<=t&&i.add(e.indexedLabel);return i}bboxCollides(e,t){for(const i of this.tree.search(e))if(i.indexedLabel.order<=t)return!0;return!1}labelCollides(e,t){for(const i of e.bboxes)for(const e of this.tree.search(i))if(e.indexedLabel.order<=t)return!0;return!1}deduplicationCollides(e){if(!e.deduplicationKey||!e.deduplicationDistance)return!1;const t=e.deduplicationDistance,i={minX:e.anchor.x-t,minY:e.anchor.y-t,maxX:e.anchor.x+t,maxY:e.anchor.y+t};for(const n of this.tree.search(i))if(n.indexedLabel.deduplicationKey===e.deduplicationKey&&n.indexedLabel.anchor.dist(e.anchor)<t)return!0;return!1}makeEntry(e){this.current.get(e)&&console.log("consistency error 1");const t=new Set;this.current.set(e,t)}insert(t,i,n){const a={anchor:t.anchor,bboxes:t.bboxes,draw:t.draw,order:i,tileKey:n,deduplicationKey:t.deduplicationKey,deduplicationDistance:t.deduplicationDistance};let s=this.current.get(n);if(!s){const e=new Set;this.current.set(n,e),s=e}s.add(a);let o=!1,r=!1;for(const e of t.bboxes)this.tree.insert({minX:e.minX,minY:e.minY,maxX:e.maxX,maxY:e.maxY,indexedLabel:a}),e.minX<0&&(o=!0),e.maxX>this.dim&&(r=!0);if(o||r){const a=o?this.dim:-this.dim,s=[];for(const e of t.bboxes)s.push({minX:e.minX+a,minY:e.minY,maxX:e.maxX+a,maxY:e.maxY});const r={anchor:new e(t.anchor.x+a,t.anchor.y),bboxes:s,draw:t.draw,order:i,tileKey:n},l=this.current.get(n);l&&l.add(r);for(const e of s)this.tree.insert({minX:e.minX,minY:e.minY,maxX:e.maxX,maxY:e.maxY,indexedLabel:r})}}pruneOrNoop(e){const t=e.split(":");let i,n=0,a=0;for(const e of this.current.keys()){const s=e.split(":");if(s[3]===t[3]){a++;const o=Math.sqrt(Math.pow(+s[0]-+t[0],2)+Math.pow(+s[1]-+t[1],2));o>n&&(n=o,i=e)}i&&a>this.maxLabeledTiles&&this.pruneKey(i)}}pruneKey(e){const t=this.current.get(e);if(!t)return;const i=[];for(const e of this.tree.all())t.has(e.indexedLabel)&&i.push(e);for(const e of i)this.tree.remove(e);this.current.delete(e)}removeLabel(e){const t=[];for(const i of this.tree.all())e===i.indexedLabel&&t.push(i);for(const e of t)this.tree.remove(e);const i=this.current.get(e.tileKey);i&&i.delete(e)}}class pe{constructor(e,t,i,n,a){this.index=new be(256<<e,n),this.z=e,this.scratch=t,this.labelRules=i,this.callback=a}layout(e){const t=performance.now(),i=new Set;for(const[t,n]of e)for(const e of n){const n=`${g(e.dataTile)}:${t}`;this.index.has(n)||(this.index.makeEntry(n),i.add(n))}const n=new Set;for(const[t,a]of this.labelRules.entries()){if(!1===a.visible)continue;if(a.minzoom&&this.z<a.minzoom)continue;if(a.maxzoom&&this.z>a.maxzoom)continue;const s=a.dataSource||"",o=e.get(s);if(o)for(const e of o){const o=`${g(e.dataTile)}:${s}`;if(!i.has(o))continue;const r=e.data.get(a.dataLayer);if(void 0===r)continue;const l=r;a.sort&&l.sort(((e,t)=>a.sort?a.sort(e.props,t.props):0));const c={index:this.index,zoom:this.z,scratch:this.scratch,order:t,overzoom:this.z-e.dataTile.z};for(const i of l){if(a.filter&&!a.filter(this.z,i))continue;const s=fe(i.geom,e.scale,e.origin),r=a.symbolizer.place(c,s,i);if(r)for(const i of r){let a=!1;if(!i.deduplicationKey||!this.index.deduplicationCollides(i)){if(this.index.labelCollides(i,1/0)){if(!this.index.labelCollides(i,t)){const s=this.index.searchLabel(i,1/0);for(const t of s){this.index.removeLabel(t);for(const i of t.bboxes)this.findInvalidatedTiles(n,e.dim,i,o)}this.index.insert(i,t,o),a=!0}}else this.index.insert(i,t,o),a=!0;if(a)for(const t of i.bboxes)(t.maxX>e.origin.x+e.dim||t.minX<e.origin.x||t.minY<e.origin.y||t.maxY>e.origin.y+e.dim)&&this.findInvalidatedTiles(n,e.dim,t,o)}}}}}for(const e of i)this.index.pruneOrNoop(e);return n.size>0&&this.callback&&this.callback(n),performance.now()-t}findInvalidatedTiles(e,t,i,n){const a=me(this.z,t,i);for(const t of a)t.key!==n&&this.index.hasPrefix(t.key)&&e.add(t.display)}add(e){let t=!0;for(const[i,n]of e)for(const e of n)this.index.has(`${g(e.dataTile)}:${i}`)||(t=!1);if(t)return 0;return this.layout(e)}}class ge{constructor(e,t,i,n){this.labelers=new Map,this.scratch=e,this.labelRules=t,this.maxLabeledTiles=i,this.callback=n}add(e,t){let i=this.labelers.get(e);return i||(i=new pe(e,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(e,i)),i.add(t)}getIndex(e){const t=this.labelers.get(e);if(t)return t.index}}function ye(t,i,n,a,s,o,r,l,c){const f=performance.now();t.save(),t.miterLimit=2;for(const a of s){if(a.minzoom&&i<a.minzoom)continue;if(a.maxzoom&&i>a.maxzoom)continue;const s=n.get(a.dataSource||"");if(s)for(const i of s){const n=i.data.get(a.dataLayer);if(void 0===n)continue;a.symbolizer.before&&a.symbolizer.before(t,i.z);const s=i.origin,c=i.dim,f=i.scale;if(t.save(),l){t.beginPath();const e=Math.max(s.x-r.x,o.minX-r.x),i=Math.max(s.y-r.y,o.minY-r.y),n=Math.min(s.x-r.x+c,o.maxX-r.x),a=Math.min(s.y-r.y+c,o.maxY-r.y);t.rect(e,i,n-e,a-i),t.clip()}t.translate(s.x-r.x,s.y-r.y);for(const r of n){let n=r.geom;const l=r.bbox;l.maxX*f+s.x<o.minX||l.minX*f+s.x>o.maxX||l.minY*f+s.y>o.maxY||l.maxY*f+s.y<o.minY||(a.filter&&!a.filter(i.z,r)||(1!==f&&(n=fe(n,f,new e(0,0))),a.symbolizer.draw(t,n,i.z,r)))}t.restore()}}if(l&&(t.beginPath(),t.rect(o.minX-r.x,o.minY-r.y,o.maxX-o.minX,o.maxY-o.minY),t.clip()),a){const e=a.searchBbox(o,1/0);for(const i of e)if(t.save(),t.translate(i.anchor.x-r.x,i.anchor.y-r.y),i.draw(t),t.restore(),c){t.lineWidth=.5,t.strokeStyle=c,t.fillStyle=c,t.globalAlpha=1,t.fillRect(i.anchor.x-r.x-2,i.anchor.y-r.y-2,4,4);for(const e of i.bboxes)t.strokeRect(e.minX-r.x,e.minY-r.y,e.maxX-e.minX,e.maxY-e.minY)}}return t.restore(),performance.now()-f}var _e=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const we=6378137,xe=85.0511287798,ke=we*Math.PI,ve=t=>{const i=Math.PI/180,n=Math.max(Math.min(xe,t.y),-xe),a=Math.sin(n*i);return new e(we*t.x*i,we*Math.log((1+a)/(1-a))/2)},ze=(t,i)=>n=>{const a=ve(n);return new e((a.x+ke)/(2*ke),1-(a.y+ke)/(2*ke)).mult(256*(1<<i)).sub(t)},Me=(t,i)=>n=>{const a=new e(n.x,n.y).add(t).div(256*(1<<i));return(e=>{const t=180/Math.PI;return{lat:(2*Math.atan(Math.exp(e.y/we))-Math.PI/2)*t,lng:e.x*t/we}})(new e(a.x*(2*ke)-ke,(1-a.y)*(2*ke)-ke))},Te=(e,t)=>{const i=t*(360/e);return Math.log2(i/256)};class Le{constructor(e){if(e.theme){const t=le[e.theme];this.paintRules=oe(t),this.labelRules=re(t),this.backgroundColor=t.background}else this.paintRules=e.paintRules||[],this.labelRules=e.labelRules||[],this.backgroundColor=e.backgroundColor;this.views=ue(e),this.debug=e.debug||""}drawContext(t,i,n,a,s){return _e(this,void 0,void 0,(function*(){const o=ve(a),r=new e((o.x+ke)/(2*ke),1-(o.y+ke)/(2*ke)).clone().mult(256*Math.pow(2,s)).sub(new e(i/2,n/2)),l={minX:r.x,minY:r.y,maxX:r.x+i,maxY:r.y+n},c=[];for(const[e,t]of this.views){const i=t.getBbox(s,l);c.push({key:e,promise:i})}const f=yield Promise.all(c.map((e=>e.promise.then((t=>({status:"fulfilled",value:t,key:e.key})),(t=>({status:"rejected",value:[],reason:t,key:e.key})))))),h=new Map;for(const e of f)"fulfilled"===e.status&&h.set(e.key,e.value);const d=performance.now(),u=new pe(s,t,this.labelRules,16,void 0);u.add(h),this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,i,n),t.restore());const m=this.paintRules;if(ye(t,s,h,u.index,m,l,r,!0,this.debug),this.debug){t.save(),t.translate(-r.x,-r.y),t.strokeStyle=this.debug,t.fillStyle=this.debug,t.font="12px sans-serif";let e=0;for(const[i,n]of h){for(const a of n){t.strokeRect(a.origin.x,a.origin.y,a.dim,a.dim);const n=a.dataTile;t.fillText(`${i+(i?" ":"")+n.z} ${n.x} ${n.y}`,a.origin.x+4,a.origin.y+14*(1+e))}e++}t.restore()}return{elapsed:performance.now()-d,project:ze(r,s),unproject:Me(r,s)}}))}drawCanvas(e,t,i,n={}){return _e(this,void 0,void 0,(function*(){const a=window.devicePixelRatio,s=e.clientWidth,o=e.clientHeight;e.width===s*a&&e.height===o*a||(e.width=s*a,e.height=o*a),n.lang&&(e.lang=n.lang);const r=e.getContext("2d");if(r)return r.setTransform(a,0,0,a,0,0),this.drawContext(r,s,o,t,i);console.error("Failed to initialize canvas2d context.")}))}drawContextBounds(t,i,n,a,s){return _e(this,void 0,void 0,(function*(){const o=n.x-i.x,r=new e((i.x+n.x)/2,(i.y+n.y)/2);return this.drawContext(t,a,s,r,Te(o,a))}))}drawCanvasBounds(t,i,n,a,s={}){return _e(this,void 0,void 0,(function*(){const o=n.x-i.x,r=new e((i.x+n.x)/2,(i.y+n.y)/2);return this.drawCanvas(t,r,Te(o,a),s)}))}}var Ce=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const Ye=e=>e.then((e=>({status:"fulfilled",value:e})),(e=>({status:"rejected",reason:e}))),je=(t={})=>{class i extends L.GridLayer{constructor(e={}){if(e.noWrap&&!e.bounds&&(e.bounds=[[-90,-180],[90,180]]),null==e.attribution&&(e.attribution='<a href="https://protomaps.com">Protomaps</a> © <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(e),e.theme){const t=le[e.theme];this.paintRules=oe(t),this.labelRules=re(t),this.backgroundColor=t.background}else this.paintRules=e.paintRules||[],this.labelRules=e.labelRules||[],this.backgroundColor=e.backgroundColor;this.lastRequestedZ=void 0,this.tasks=e.tasks||[],this.views=ue(e),this.debug=e.debug;const t=document.createElement("canvas").getContext("2d");this.scratch=t,this.onTilesInvalidated=e=>{for(const t of e)this.rerenderTile(t)},this.labelers=new ge(this.scratch,this.labelRules,16,this.onTilesInvalidated),this.tileSize=256*window.devicePixelRatio,this.tileDelay=e.tileDelay||3,this.lang=e.lang}renderTile(t,i,n,a=(()=>{})){return Ce(this,void 0,void 0,(function*(){this.lastRequestedZ=t.z;const s=[];for(const[e,i]of this.views){const n=i.getDisplayTile(t);s.push({key:e,promise:n})}const o=yield Promise.all(s.map((e=>e.promise.then((t=>({status:"fulfilled",value:t,key:e.key})),(t=>({status:"rejected",reason:t,key:e.key})))))),r=new Map;for(const e of o)"fulfilled"===e.status?r.set(e.key,[e.value]):"AbortError"===e.reason.name||console.error(e.reason);if(i.key!==n)return;if(this.lastRequestedZ!==t.z)return;if(yield Promise.all(this.tasks.map(Ye)),i.key!==n)return;if(this.lastRequestedZ!==t.z)return;const l=this.labelers.add(t.z,r);if(i.key!==n)return;if(this.lastRequestedZ!==t.z)return;const c=this.labelers.getIndex(t.z);if(!this._map)return;const f=this._map.getCenter().wrap(),h=this._getTiledPixelBounds(f),d=this._pxBoundsToTileRange(h).getCenter(),u=t.distanceTo(d)*this.tileDelay;var m;if(yield(m=u,new Promise((e=>{setTimeout((()=>{e()}),m)}))),i.key!==n)return;if(this.lastRequestedZ!==t.z)return;const b={minX:256*t.x-16,minY:256*t.y-16,maxX:256*(t.x+1)+16,maxY:256*(t.y+1)+16},p=new e(256*t.x,256*t.y);i.width=this.tileSize,i.height=this.tileSize;const g=i.getContext("2d");if(!g)return void console.error("Failed to get Canvas context");g.setTransform(this.tileSize/256,0,0,this.tileSize/256,0,0),g.clearRect(0,0,256,256),this.backgroundColor&&(g.save(),g.fillStyle=this.backgroundColor,g.fillRect(0,0,256,256),g.restore());let y=0;const _=this.paintRules;if(y=ye(g,t.z,r,this.xray?null:c,_,b,p,!1,this.debug),this.debug){g.save(),g.fillStyle=this.debug,g.font="600 12px sans-serif",g.fillText(`${t.z} ${t.x} ${t.y}`,4,14),g.font="12px sans-serif";let e=28;for(const[t,i]of r){const n=i[0].dataTile;g.fillText(`${t+(t?" ":"")+n.z} ${n.x} ${n.y}`,4,e),e+=14}g.font="600 10px sans-serif",y>8&&(g.fillText(`${y.toFixed()} ms paint`,4,e),e+=14),l>8&&g.fillText(`${l.toFixed()} ms layout`,4,e),g.strokeStyle=this.debug,g.lineWidth=.5,g.beginPath(),g.moveTo(0,0),g.lineTo(0,256),g.stroke(),g.lineWidth=.5,g.beginPath(),g.moveTo(0,0),g.lineTo(256,0),g.stroke(),g.restore()}a()}))}rerenderTile(e){for(const t in this._tiles){const i=this._wrapCoords(this._keyToTileCoords(t));e===this._tileCoordsToKey(i)&&this.renderTile(i,this._tiles[t].el,e)}}queryTileFeaturesDebug(e,t,i=16){const n=new Map;for(const[a,s]of this.views)n.set(a,s.queryFeatures(e,t,this._map.getZoom(),i));return n}clearLayout(){this.labelers=new ge(this.scratch,this.labelRules,16,this.onTilesInvalidated)}rerenderTiles(){for(const e in this._tiles){const t=this._wrapCoords(this._keyToTileCoords(e)),i=this._tileCoordsToKey(t);this.renderTile(t,this._tiles[e].el,i)}}createTile(e,t){const i=L.DomUtil.create("canvas","leaflet-tile");i.lang=this.lang;const n=this._tileCoordsToKey(e);return i.key=n,this.renderTile(e,i,n,(()=>{t(void 0,i)})),i}_removeTile(e){const t=this._tiles[e];t&&(t.el.removed=!0,t.el.key=void 0,L.DomUtil.removeClass(t.el,"leaflet-tile-loaded"),t.el.width=t.el.height=0,L.DomUtil.remove(t.el),delete this._tiles[e],this.fire("tileunload",{tile:t.el,coords:this._keyToTileCoords(e)}))}}return new i(t)};var Se=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const Xe=(e,t,i)=>{const n=new FontFace(e,`url(${t})`,{weight:i});return document.fonts.add(n),n.load()},Pe=e=>Se(void 0,void 0,void 0,(function*(){return new Promise(((t,i)=>{const n=new Image;n.onload=()=>t(n),n.onerror=()=>i("Invalid SVG"),n.src=e}))}));class De{constructor(e){this.src=e,this.canvas=document.createElement("canvas"),this.mapping=new Map,this.missingBox={x:0,y:0,w:0,h:0}}load(){return Se(this,void 0,void 0,(function*(){let e=this.src;const t=window.devicePixelRatio;if(e.endsWith(".html")){const t=yield fetch(e);e=yield t.text()}const i=(new window.DOMParser).parseFromString(e,"text/html"),n=Array.from(i.body.children),a=yield Pe(`data:image/svg+xml;base64,${btoa('\n<svg width="20px" height="20px" viewBox="0 0 50 50" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <rect width="50" height="50" fill="#cccccc"/>\n    <g transform="translate(5,5)">\n        <path fill="none" stroke="#666666" stroke-width="7" d="m11,12a8.5,8 0 1,1 17,0q0,4-4,6t-4.5,4.5-.4,4v.2m0,3v7"/>\n    </g>\n</svg>\n')}`),s=[{w:a.width*t,h:a.height*t,img:a,id:""}],r=new XMLSerializer;for(const e of n){const i=`data:image/svg+xml;base64,${btoa(r.serializeToString(e))}`,n=yield Pe(i);s.push({w:n.width*t,h:n.height*t,img:n,id:e.id})}const l=o(s);this.canvas.width=l.w,this.canvas.height=l.h;const c=this.canvas.getContext("2d");if(c)for(const e of s)void 0!==e.x&&void 0!==e.y&&(c.drawImage(e.img,e.x,e.y,e.w,e.h),e.id?this.mapping.set(e.id,{x:e.x,y:e.y,w:e.w,h:e.h}):this.missingBox={x:e.x,y:e.y,w:e.w,h:e.h});return this}))}get(e){let t=this.mapping.get(e);return t||(t=this.missingBox),t}}export{J as CenteredSymbolizer,Q as CenteredTextSymbolizer,E as CircleSymbolizer,Z as FlexSymbolizer,Xe as Font,b as GeomType,H as GroupSymbolizer,K as IconSymbolizer,be as Index,R as Justify,pe as Labeler,ge as Labelers,ie as LineLabelPlacement,ne as LineLabelSymbolizer,q as LineSymbolizer,ee as OffsetSymbolizer,te as OffsetTextSymbolizer,V as Padding,w as PmtilesSource,I as PolygonSymbolizer,De as Sheet,O as ShieldSymbolizer,Le as Static,F as TextPlacements,G as TextSymbolizer,D as TileCache,de as View,x as ZxySource,B as arr,me as covering,$ as createPattern,W as exp,Te as getZoom,j as isCcw,Y as isInRing,re as labelRules,je as leafletLayer,A as linear,ye as paint,oe as paintRules,S as pointInPolygon,P as pointMinDistToLines,X as pointMinDistToPoints,ue as sourcesToViews,N as step,g as toIndex,fe as transformGeom,he as wrap};export default null;
